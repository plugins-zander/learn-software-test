# QTR

 QTP测试工具

- QTP简介

  - QTP是quicktest Professional的简称，是一种B/S自动测试工具。

  - QTP提供符合所有主要应用软件环境的功能测试和回归测试的自动化。

  - 采用关键字驱动的理念能够简化测试用例的创建和维护。

  - QTP的启动

    - 途经一
      - 通过选择菜单“开始/所有程序/HP Software/HP Unified Functional Testing”来启动
    - 途经二
      - 直接双击桌面上的HP Unified Functional Testing快捷图标

  - QTP的操作步骤

    - 

      ![img](https://img1.zlogs.net/20/20200117222732.png)

- QTP的基本功能

  - QuickTest Professional 支持功能测试和回归测试自动化，用于每个主要软件应用程序和环境。

  - 它使测试人员能够使用专业的捕获技术直接从应用程序屏幕中捕获流程来构建测试案例。

  - QTP的基本功能包括两大部分：一部分是提供给初级用户使用的关键字视图；另一部分是提供给熟悉VBScript脚本编写的自动化测试工程师使用的编辑视图，在实际的自动化测试项目中完全可以结合着使用。

  - 录制测试脚本

    - （1）开始录制。设置成仅录制“Flight”程序后，选择菜单“录制—>录制和运行设置”，或者按快捷键F6，QTP将自动启动指定目录下的“Flight”程序
    - ​    （2）停止录制。按“停止”按钮停止录制，在关键字视图中，可看到录制的测试操作步骤，每个测试步骤涉及的界面操作都会在Active Screen界面显示出来。

  - 编辑录制测试脚本

    - 

      ![img](https://img1.zlogs.net/20/20200117222733.png)

  - 调试与运行测试脚本

    - 在编辑好测试脚本后，在运行测试之前，可利用QTP的语法检查功能和脚本调试功能对测试脚本的逻辑进行检查。
    - 具体应用如下：
      - （1）语法检查
        - 选择菜单“设计—>检查语法”，或者按快捷键“Ctrl+F7”对测试脚本进行语法检查，如果语法检查通过，则在“消息”界面（可通过选择菜单“查看—>错误”打开）提示信息“语法有效”，表示语法检查通过。
      - （2）使用断点
        - 语法检查通过后，可直接运行测试脚本，也可设置断点对脚本进行调试。然后按F5键运行测试脚本，运行过程中将在断点所在的代码行停住。
      - （3）单步调试
        - 选择菜单“运行—>运行到该步骤”，或者按快捷键“Ctrl+F10”跳到下一行代码，也可以选择“运行—>步入”，或者按快捷键“F11”进入代码行中所调用的函数“Test1”。
      - （4）调试查看器的使用
        - 选择菜单“查看—>调试查看器”，在文本框输入测试对象属性或变量，可查看其值。
      - （5）运行整个测试
        - 选择菜单“工具—>选项”，在出现的界面里，在“GUI测试—>测试运行”选项中的“运行模式”，可选择为“普通”或“快速”。
      - （6）运行部分测试
        - 选择菜单“运行—>运行当前操作”，仅仅运行当前的Action，这种方式有利于单独运行Action，查看单个Action测试执行的情况，有利于定位当前Action运行的问题。
      - （7）批量运行测试
        - 在QTP中选择菜单“工具—>选项—> GUI测试—>测试运行”，打开界面，确保“允许其他HP产品运行测试和组件”选项被勾选上。
        - 选择“开始—>所有程序—>QuickTest Profession—>Tools—>Test Batch Runner”启动Test Batch Runner。在Test Batch Runner中，选择“批量运行”来批量运行列表中的所有测试脚本。

  - 分析测试结果

    - 自动化测试的最后一个步骤就是运行测试并检查测试结果，这个步骤也是非常重要的，测试员根据测试结果来判断测试是否通过，检查测试脚本是否正确地完成了测试。

    - 图示

      - 

        ![img](https://img1.zlogs.net/20/20200117222734.png)

- QTP的测试使用

  - 测试计划需要确定测试对象、测试组织、测试任务划分、测试失败/通过的标准、挂起恢复的条件、时间安排、资源安排、风险估计和应急计划等，可分为主测试计划、单元测试计划、集成测试计划、系统测试计划和接收测试计划等。

  - 录制测试脚本与执行

    - 1、执行Quick Test并开启一个全新的测试脚本

      - 方法：
      - 启动 QuickTest  并打开新测试
      - “欢迎使用”窗口单击“空白测试”
      - “工具”-“选项”中打开“插件管理器”

    - 2、开始在 Mercury Tours 网站上录制测试脚本

      - （1）点击菜单中的 “录制/录制F6”，或单击“录制”按钮 。将打开“录制和运行设置”对话窗口，如图8-16所示。

      - （2）在“Web”标签页面选择“录制或运行会话开始时打开以下”，并勾选“使用以下方式为运行会话参数化浏览器类型”，然后按确定。

      - （3）确认“当测试关闭时关闭浏览器”和“不在已经打开的浏览器上录制和运行”处于选定状态。

      - （4）在“Windows Applications”选项卡中，确认“下面指定的应用程序（B）”处于选定状态，且未列出任何应用程序。

      - （5）如果选择“在任何打开的浏览器上录制和运行测试（R）”单选按钮，则在录制过程中，QuickTest会记录你对所有的Windows程序所做的操作。如果选择“下面指定的应用程序（B）”单选按钮，则在录制过程中，QuickTest会记录对那些添加到下面“应用程序详细信息”列表框中的应用程序的操作

      - （6）我们选择第二个单选按钮，因为我们只是对Mercury Tours范例网站进行操作，不涉及Windows应用程序，所有保持列表为空。

      - （7）点击“确定”按钮，开始进行录制，将自动打开IE浏览器并连接到Mercury Tours范例网站上。

        - 如图8-1所示

          - 

            ![img](https://img1.zlogs.net/20/20200117222735.png)

    - 3、登录Mercury Tours网站

      - 在“User Name”和“Password”框中，输入在 Mercury Tours 中注册的用户名和密码，单击“Sign-in”，将打开“Flight Finder”网页

      - 如图8-2所示

        - 

          ![img](https://img1.zlogs.net/20/20200117222736.png)

    - 4、输入航班详细信息

      - 输入以下订票数据：
      - Departing From：New York
      - On：Oct 29
      - Arriving In：San Francisco
      - Returning：Nov 11
      - Service Class：Business class
      - 其他字段保留默认值，单击“CONTINUE”，将打开“SELECT FLIGHT”页面。

    - 5、选择飞机航班

      - 可以保留默认值，点击“CONTINUE”按钮，打开“Book a Flight”页面。

    - 6、输入必填字段

      - 在“Passengers”和“Credit Card”部分输入所需信息，在“Billing Address”部分，选择“Ticketless Travel”，在该页底部，单击“SECURE PURCHASE”，将打开“Flight Confirmation”页。 

    - 7、完成定制流程

      - 查看订票数据，并选择“BACK TO HOME”，回到Mercury Tours网站首页。

    - 8、停止录制

      -  在 QuickTest 中，单击“测试”工具栏上的“停止” ，停止录制进程。

    - 9、保存测试脚本

      - 选择“文件”>“保存”，或单击“保存”按钮 。将打开“保存”对话框，且显示为“GUITest”文件夹。创建名为Tours 的文件夹，将其选中，然后单击“打开”。
      - 在“文件名”字段中键入 Flight，单击“保存”。测试名 “Flight” 将显示在主 QuickTest 窗口中的标题栏中。

  - 基本测试（同步点、各类检查点）

    - 图示

      - 

        ![img](https://img1.zlogs.net/20/20200117222737.png)

    - 1、同步点测试

      - （1）增加QTP预设等待的时间
      - （2）变更预设等待时间的设定
      - （3）识别以同步点解决的问题
      - （4）插入同步点
      - （5）储存测试脚本
      - （6）执行测试脚本并查看结果
      - （7）关闭测试结果和测试脚本

    - 2、检查点测试

      - （1）标准检查点

        ![img](https://img1.zlogs.net/20/20200117222738.png)

      - （2）页面检查点

      - （3）文本检查点

      - （4）表检查点

    - 3、运行检查点并分析测试结果

      - 1、运行检查点
      - 2、分析测试结果

  - 数据驱动测试

    - 建立好测试脚本后，测试人员可能会想要用多组不同的数据去执行测试脚本。为此，测试人员可以将测试脚本转换成数据驱动（Data-Driven）测试脚本，并建立一个数据表提供测试所需要的多组数据。

    - 图示

      - 

        ![img](https://img1.zlogs.net/20/20200117222739.png)

    - 1、数据驱动测试方法

      - 数据驱动的测试方法要解决的核心问题是把数据从测试脚本中分离出来，从而实现测试脚本参数化。
      - （1）数据驱动测试的时间
      - （2）数据驱动测试的步骤

    - 2、参数化测试

      - 通过把测试脚本中固定的值替换成参数的方式来扩展测试脚本，这个过程也叫参数化测试，能有效地提高测试的灵活性。
      - （1）通过参数化测试来提高测试的灵活性
      - （2）参数化测试操作步骤
      - （3）使用随机数来进行参数化
      - （4）参数化检查点
      - （5）设置数据表格迭代方式

    - 3、Action测试输入的参数化

      - 在QTP中，对于重复使用的测试用例，可以转换成公共用例，适当参数化后，可被其他测试用例调用。
      - （1）编辑Action的属性
      - （2）添加Action的输入参数
      - （3）调用Action

    -  4、使用环境变量的参数化

      - 在QTP中，除了前面所讲的几种参数化测试的方式外，还可以使用环境变量来进行测试的参数化。使用环境变量来参数化测试步骤如下：
      - （1）定义和设置环境变量；
      - （2）在测试步骤中绑定环境变量值；
      - （3）输出环境变量到XML文件；
      - （4）导入外部环境变量文件。

    - 5、使用数据驱动器来参数化测试

      - 为了简化测试脚本参数化的过程，QTP还提供了名为“数据驱动”的功能，可自动检测脚本中可能需要进行参数化的变量。
      - （1）数据驱动器的使用方法
      - （2）数据驱动向导