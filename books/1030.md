# 集成测试

## 集成测试的概述

### 集成测试的定义

- 集成测试，也叫组装测试或联合测试。在单元测试的基础上，将所有模块按照设计要求组装成为子系统或系统，进行集成测试。

- 集成测试是单元测试的逻辑扩展。在现实方案中，集成是指多个单元的聚合，许多单元组合成模块，而这些模块又聚合成程序的更大部分，如分系统或系统。集成测试采用的方法是测试软件单元的组合能否正常工作，以及与其他组的模块能否集成起来工作。最后，还要测试构成系统的所有模块组合能否正常工作。集成测试所持的主要标准是《软件概要设计规格说明》，任何不符合该说明的程序模块行为都应该加以记载并上报。

### 集成测试关注的主要内容

  - （1）模块接口的数据交换；
  - （2）各子功能组合起来能否达到预期要求的父功能；
  - （3）模块间是否有不利影响；
  - （4）全局数据结构是否有问题；
  - （5）单个模块的误差是否会累积放大。

### 集成测试的目标
  - 集成测试的目标是按照设计要求使用那些通过单元测试的构件来构造程序结构。单个模块具有高质量但不足以保证整个系统的高质量。有许多隐蔽的失效是高质量模块间发生非预期交互而产生的。
  - 判断集成测试是否完成，可从以下几个方面进行检查：
    - （1）成功地执行了测试计划中规定的所有集成测试；
    - （2）修正了所发现的错误；
    - （3）测试结果通过了专门小组的评审。
  - 集成测试应由专门的测试小组来进行，测试小组是由有经验的系统设计人员和程序员组成。整个测试活动要在评审人员出席的情况下进行。
  - 测试小组应负责对测试结果进行整理、分析，形成测试报告。测试报告中要记录实际的测试结果、在测试中发现的问题、解决这些问题的方法以及解决之后再次测试的结果。此外还应提出不能解决、还需要管理人员和开发人员注意的一些问题，提供测试评审和最终决策，以便提出处理意见。

### 集成测试的方法

  - #### 常用的集成测试方法有：

    - 大爆炸集成（Big bang integration)
    - 自顶向下集成（Top down integration）
    - 自底向上集成（Bottom up integration)
    - 三明治集成（Sandwich testing）

  - #### 大爆炸集成测试

    - 大爆炸集成测试概述

      - 大爆炸集成也称为一次性组装或整体拼装，是一种非增量式组装方式。

      - 这种集成测试策略的做法就是把所有通过单元测试的模块一次性集成到一起进行测试，不考虑组件之间的互相依赖性及可能存在的风险。

      - 例子

        - 

          ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222719.png)

    - 大爆炸集成测试优点

      - （1）可以并行测试所有模块。
      - （2）需要的测试用例数目少。
      - （3）测试方法简单、易行。

    - 大爆炸集成测试缺点

      - （1）一次运行成功的可能性不大。
      - （2）如果一次集成的模块数量多，集成测试后可能会出现大量的错误。很可能新增更多的新错误，新旧错误混杂，给程序的错误定位与修改带来很大的麻烦。
      - （3）即使集成测试通过，也会遗漏很多错误。

    - 大爆炸集成测试适用范围

      - （1）只需要修改或增加少数几个模块的前期产品稳定的项目；
      - （2）功能少，模块数量不多，程序逻辑简单，并且每个组件都已经过充分单元测试的小型项目；
      - （3）基于严格的净室软件工程（由IBM公司开创的开发接近零缺陷的软件的成功做法）开发的产品，并且在每个开发阶段，产品质量和单元测试质量都是相当高质量的产品。

  - #### 自顶向下集成测试

    - 自顶向下集成测试概述

      - 自顶向下的集成测试就是按照系统层次结构图，以主程序模块为中心，从顶层控制（主控模块）开始，自上而下按照深度优先或者广度优先策略，对各个模块一边组装一边进行测试。
      - 采用同设计顺序一样的思路对被测系统进行测试，来验证系统的功能性和稳定性。

    - 自顶向下集成测试步骤

      - （1）先对主控模块进行测试，用桩模块代替所有直接附属于主控模块的模块。

      - （2）根据选定的优先策略（广度或深度优先），每次用一个实际模块代替一个桩模块进行测试。

      - （3）结合下一模块的同时进行测试。

      - （4）为了保证加入的模块没有引入新的错误，需要进行回归测试。

      - （5）重复（2）-（4）过程，直到所有的模块集成测试完成。

      - 例子

        - 

          ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222720.png)

    - 自顶向下集成测试优点

      - (1)较早验证了主要的控制和判断点；
      - (2)功能可行性较早得到证实；
      - (3)最多只需要一个驱动模块；
      - (4)可以与设计并行进行测试；
      - (5)支持故障隔离等。

    - 自顶向下集成测试缺点

      - (1)桩开发和维护的成本大；
      - (2)底层组件的一个需求的修改会导致许多顶层组件的修改；
      - (3)底层模块越多，会导致底层测试不充分。

    - 自顶向下集成测试适用范围

      - 自顶向下集成测试主要适合于结构化编程方法的软件产品，且产品结构相对简单。

  - #### 自底向上集成测试

    - 自底向上集成测试概述

      - 自底向上集成是从系统层次结构图的最底层模块开始按照层次结构图，逐层向上进行组装和集成测试的方式。

    - 自底向上集成测试测试步骤

      - （1）从最底层的模块开始组装测试；

      - （2）编写驱动程序，协调测试用例的输入与输出；

      - （3）测试集成后的构件；

      - （4）使用实际模块代替驱动程序，按程序结构向上组装测试后的构件；

      - （5）重复（2）-（4）步骤，直到系统的最顶层模块被加入到系统中测试完成为止。

      - 例子

        - 

          ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222721.png)

    - 自底向上集成测试优点

      - 较早验证底层模块；
      - 工作最初可以并行集成测试，集成策略小；
      - 减少桩模块编写的工作量，支持故障隔离。

    - 自底向上集成测试缺点

      - 动模块开发工作量大；
      - 对高层的验证在最后，设计上的错误不能被及时发现。

    - 自底向上集成测试适用范围

      - 自底向上集成测试适应于大部分采用结构化编程方法的软件产品，且产品结构相对简单。

  - #### 三明治集成测试

    - 三明治集成测试概述
      - 三明治集成是一种混合增殖式测试策略，综合了自顶向下和自底向上两种集成方法，把系统划分成三层，中间一层为目标层，目标层上采用自顶向下集成，目标层下采用自底向上集成。
      - 例5-5 对于图5-3中的模块，我们采用三明治集成测试。
      - 对分别已进行了单元测试的各个模块，在下层分别集成模块B、E、F和D、G进行测试，在上层集成模块A、B、C、D进行测试，最后将所有模块集成测试。
    - 三明治集成测试优点
      - 集合了自顶向下和自底向下上两种集成测试的优点。
    - 三明治集成测试缺点
      - 由于中间层是最后集成测试，因此中间层在被集成前测试不充分。
    - 三明治集成测试适用范围
      - 对大部分开发软件项目都可以使用。

  - #### 其他集成测试策略

    - 核心系统测试
      - 核心系统先行集成测试法的思想是先对核心软件部件进行集成测试，在测试通过的基础上再按各外围软件部件的重要程度逐个集成到核心系统中。每次加入一个外围软件部件都产生一个产品基线，直至最后形成稳定的软件产品。核心系统先行集成测试法对应的集成过程是一个逐渐趋于闭合的螺旋形曲线，代表产品逐步定型的过程。
      - 优点
        - 该集成测试方法对于快速软件开发很有效果，适合较复杂系统的集成测试，能保证一些重要的功能和服务的实现。
      - 缺点
        - 采用此法的系统一般应能明确区分核心软件部件和外围软件部件，核心软件部件应具有较高的耦合度，外围软件部件内部也应具有较高的耦合度，但各外围软件部件之间应具有较低的耦合度。
    - 高频集成测试
      - 高频集成测试是指同步于软件开发过程，每隔一段时间对开发团队的现有代码进行一次集成测试。
      - 如某些自动化集成测试工具能实现每日深夜对开发团队的现有代码进行一次集成测试，然后将测试结果发到各开发人员的电子邮箱中。该集成测试方法频繁地将新代码加入到一个已经稳定的基线中，以免集成故障难以发现，同时控制可能出现的基线偏差。
      - 优点
        - 该测试方案能在开发过程中及时发现代码错误，能直观地看到开发团队的有效工程进度。
      - 缺点
        - 在于测试包有时候可能不能暴露深层次的编码错误和图形界面错误。
    - 基于功能的集成测试
      - 基于功能的集成测是从功能角度出发，按照功能的关键程度对模块的集成顺序进行组织，尽可能早点进行测试。其关注于测试验证系统的关键功能。
      - 此方法适应于对较大风险的产品、技术探索的项目或者是对功能实现没有把握的产品，其功能的实现比质量要关键。
    - 基于进度的集成测试
      - 基于进度的集成测试主要是从系统的进度和质量两方面的考虑，尽早地进行集成测试，以提高开发和集成的并行性，有效地缩短项目的开发时间，提高开发项目的质量。
      - 但此方法早期测试缺乏整体性，仅能进行独立的集成，导致许多接口要到后期才能验证。桩模块与驱动模块的开发量大，模块可能不稳定产生变化，导致测试的重复与浪费。
    - 基于风险的集成测试
      - 基于风险的集成测试是基于一种假设的方法，系统的错误往往集中在系统风险最高的模块中，因此对高风险的模块接口先进行重点测试，从而保证系统的稳定性。
      - 尽早验证高风险的接口有助于加速系统的稳定性，有利加强对系统的信心。此方法可以与功能集成测试结合起来使用。主要适应于系统中风险较大的模块测试。
    - 客户/服务器的集成测试
      - 客户/服务器的集成测试主要针对客户/服务器系统，对系统客户端与服务器端交互进行集成测试。
      - 先单独测试每个客户端和服务器端，再将第一个客户端与服务端集成测试，加入下一个客户端与服务端集成测试，如此下去，将所有客户端与服务器端集成测完成。
      - 此方法对集成次序没有约束，有利于复用和扩充；支持可控制和可重复的测试。但驱动模块与桩模块的开发成本高。

### 集成测试阶段的测试过程

根据IEEE标准，集成测试过程划分为5个阶段：

- 计划阶段
- 设计阶段
- 实施阶段
- 执行阶段
- 评估阶段

#### 集成测试计划阶段

- 集成测试准备

  - 在进行集成测试前，先要准备如下内容：

  - （1）测试的文档准备：需求规格说明书、概要设计文档、产品开发计划。

  - （2）人员组织：测试人员、开发人员、测试质量控制员、测试经理、开发经理、产品经理。

  - 各相关人员职责见表5-1所示。

    - 

      ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222722.png)

- 集成测试策略和环境

  - 集成测试采用的测试技术和工具，完成测试影响的资源分配及特殊的考虑。
  - 其环境考虑内容如下：
    - （1）硬件环境： 尽可能考虑实际环境。
    - （2）操作系统环境：不同机型使用不同的操作系统版本。
    - （3）数据库环境：从性能、版本、容量等多方面考虑。
    - （4）网络环境

- 测试日程计划

  - 根据软件设计文档来评估测试有多少项目，再根据测试的工作量进行安排。
  - 开始时间在概要设计完成评审后大约一个星期。

- 活动步骤

  - （1）确定被测试对象和测试范围；
  - （2）评估集成测试被测试对象的数量及难度，即工作量 ；
  - （3）确定角色分工和任务；
  - （4）标识出测试各阶段的时间、任务、约束等条件；
  - （5）考虑一定的风险分析及应急计划；
  - （6）考虑和准备集成测试需要的测试工具，测试仪器，环境等资源；
  - （7）考虑外部技术支援的力度和深度，以及相关培训安排；
  - （8）定义测试完成标准。

- 输出

  - 集成测试计划阶段最后得到集成测试计划，此计划必须通过概要设计阶段基线评审通过。

#### 集成测试设计阶段

- 时间安排
  - 集成测试的设计在系统详细设计阶段就可以开始。
- 依据
  - 集成测试的设计阶段的主要依据是：需求规格说明书、概要设计、集成测试计划。
- 入口条件
  - 系统的概要设计基线已通过评审。
- 活动步骤
  - （1）被测对象结构分析；
  - （2）集成测试模块分析；
  - （3）集成测试接口分析；
  - （4）集成测试策略分析；
  - （5）集成测试工具分析；
  - （6）集成测试环境分析。
- 输出
  - 集成测试设计阶段的输出是集成测试设计方案。
- 出口条件
  - 集成测试设计通过详细设计基线评审。

#### 集成测试实施阶段

- 根据集成测试计划，建立集成测试环境，完成测试设计任务。

- 时间安排

  - 在系统编码阶段开始后就可以进行了。

- 依据

  - 系统的需求规格说明书、概要设计、集成测试计划、集成测试设计计划。

- 入口条件

  - 系统的详细设计基线通过评审。

- 活动步骤

  - （1）集成测试用例设计；
  - （2）集成测试代码设计（如果需要）；
  - （3）集成测试脚本设计（如果需要）；
  - （4）集成测试工具准备（如果需要）；

- 输出

  - 最后输出有：集成测试用例、集成测试规程、集成测试代码、集成测试脚本、集成测试工具。

  - 测试用例模板如表5-2所示。

    - 

      ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222723.png)

- 出口条件

  - 集成测试设计阶段的出口条件是：测试用例和测试规程通过编码阶段基线评审。

#### 集成测试执行阶段

- 按照集成测试用例设计要求进行构建平台。
- 时间安排
  - 系统的单元测试已经完成后就可以开始执行系统的集成测试了。
- 输入
  - 集成测试需要的基本内容：需求规格说明书、概要设计、集成测试计划、集成测试例、集成测试规程、集成测试代码（如果有）、集成测试脚本、集成测试工具、详细设计代码、单元测试报告。
- 入口条件
  - 系统的单元测试阶段已经通过基线化评审。
- 活动步骤
  - （1）执行集成测试用例；
  - （2）回归集成测试用例；
  - （3）撰写集成测试报告；
- 输出
  - 集成测试实施后，最后生成集成测试报告。
- 出口条件
  - 集成测试报告通过集成测试阶段基线评审。

#### 集成测试评估阶段

- 由测试设计员负责，与集成测试人员、编码员、设计员等对集成测试结果进行统计，生成测试执行报告和缺陷记录报告。
- 并对集成测试进行评估，测试结果进行评测，形成结论，最后整理形成报告。