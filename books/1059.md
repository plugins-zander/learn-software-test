# 数据流测试

## 数据流的基本概念

- （1）变量的定义和使用
  - 变量一般通过赋值来定义和初始化，并在表达式中被使用。
- （2）c-use 和p-use
  - 如果一个变量被用在赋值语句的表达式、输出语句中，或者被当作参数传递给调用函数，或者被用在下标表达式中，都称为该变量的c-use。其中c表示“计算”。
  - 如果一个变量被用在分支语句的条件表达式中，则称为变量的p-use。其中p表示“谓词”。
- （3）全局和局部的定义与使用
  - 一个变量可能在同一个基本块中被定义、使用和重定义。
  - 注：我们只关心全局变量的定义和使用，局部定义与使用在研究基于数据流的测试时没有意义。

## 数据流图

- ​	程序的数据流图（DFG）又称def-use图，它勾画了程序中变量在不同的基本块间的定义流。与程序的控制流图（CFG）有点相似，并可以从它的CFG中导出。

  ```c
  例3-12 ：考虑如下一个基本块，包含两条赋值语句和一个函数调用语句。
       P=y+z;
  	Foo(p+q,number);
  	A[i]=x+1;
  	If (x>y) {…}
  从此基本块中可知，def={p,A}，c-use={y,z,p,q,number,x,i}，p-use={x,y}。
  ```

  构造数据流图基本过程：

  - （1）计算程序中每个基本块的def 、c-use和p-use。
  - （2）将结点集中的每个结点与它对应的def 、c-use和p-use关联起来。
  - （3）针对每个具有非空p-use集并且在条件C处结束的结点，如果条件C为真时执行的边1，C为假时执行的是边2，分别将边1、边2与C，！C关联起来。

- 例子

  - 

    ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222841.png)

    ![img](https://cdn.jsdelivr.net/gh/ZanderZhao/img20/file/20200117222842.png)